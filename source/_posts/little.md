---
layout: blog
title: 费马小定理的（部分）直观解释
date: 2021-01-03 12:30:51
tags: 数论
---

## 费马小定理

费马小定理是初等数论里面一个很重要的结论。它声称：
$$
\forall p, a,Prime(p) \rightarrow a^{p}=a
$$
我仍然记得大一下学期的时候，初遇这个定理，顿觉手足无措、无所适从。我想要『理解』这个定理，换句话说，我想知道这些东西：

+ 这个定理是如何被发现的？
+ 有没有一个直观的理解可以让人『接受』这个事实？
+ 能不能从自然数的其他地方找到对这个事实的解释？

一般来说，定理的证明中有这些信息。然而，如果你搜索这个定理的证明，你会感觉到这证明实在是有点神奇：

![1](https://pic.downk.cc/item/5ff14d0b3ffa7d37b31711ff.png)

当然，如果你已经懂了本文所要说的『直观解释』，那么这个证明对你来说就如同喝白开水一样平凡。但如果你不懂，那么你并不能从证明中获得对这个定理的**理解**。那么，究竟应该如何理解这个定理呢？

## 秘密之一：有限与无限

考虑任意的$p$（不一定是素数）和$a$，令
$$
k = a^n \mod p
$$
$k$的取值是有限个还是无限个呢？显然，$k$的个数是有限个。

这是因为，$k$说到底也只能是$\Z/\Z_p$（如果不熟悉这种记法，可以把它理解为$a \pmod p$的值）里的元素，而这个集合显然是有限的。也就是说，虽然$n$是没有限制的，但$a^n \mod p$只能在一个有限范围内取值。下面把这个有限范围记为$A$.

## 秘密之二：为什么是质数？

虽然$k$的取值是有限集合$A$，可是，为什么$k$会再次回归到$a$呢？问题的关键在于$a$是不是一个可逆元素。如果它是可逆的，那么就会有一个非常有趣的性质：

因为$A$是有限的，所以至少有一个元素$t$满足$\exist n_1,n_2, a^{n_1} \equiv a^{n_2} \pmod p$，如此一来有：
$$
a^{n_1} \equiv a^{n_2} \pmod p
$$
由于$a$是可逆的，$a^{n_1}$必然是可逆的，它的逆为$(a^{-1})^{n_1}$，这样一来就有
$$
\begin{aligned}
1 \equiv& (a^{-1})^{n_2} (a^{n_2}) \pmod p \\
  \equiv& a^{n_2-n_1} \pmod p
\end{aligned}
$$
这个$a^{n_2-n_1} \pmod p$如果乘一下$a$，那么就会有：
$$
a^{n_2-n_1+1} \equiv a \pmod p
$$
可见，如果$a$可逆，那么必然有一个类似于『循环节』一样的东西，而这直接会导致$1$这个『单位元』在$A$中，$k$会再次回归到$a$是很平凡的结论。

质数这时就立了头功，在模质数的剩余类中，每一个都是可逆的。所以这会导致每一个$a$都有此性质。

不过，我们还需要继续认真考察$a^n$所生成的集合。既然存在$t=n_2-n_1$，**那么一定存在一个最小的$t$**，把最小的$t$记为$t_0$，对于任意的$n_1,n_2$，如果$n_1<t_0 \and n_2 < t_0$，那么$a^{n_1} \not \equiv a^{n_2} \pmod p$. 这也就是说，$|A|=t_0$. 

其实这也是很显然的，因为把$a^n$按$n$从大到小排列起来，$1$一定是『不同元素』中的最后一个。

## 秘密之三：拉格朗日定理

这个时候我们已经知道了$A$大致长什么样子了。然而，$t_0$到底等于多少却仍然未知。我们刚才得到这个结论的手法，用的是一个很弱的条件。如果你明白群论的话，模$p$的简化剩余系和乘法是构成了一个群的，这个群的阶数为$p-1$.

$(A,\times)$这个东西构成了一个『子群』，由拉格朗日定理，它的阶数必然是$p-1$的因子。这样一来立刻可以得到$t_0 \mid p - 1$，自然有$a^{p-1} \equiv 1 \pmod p$了。

如果不使用拉格朗日定理的证明过程，这个过程有没有直观解释呢？我暂时还没想到。

