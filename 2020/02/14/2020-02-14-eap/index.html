<!DOCTYPE html><html lang="zh-cn"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="Ayanamists"><meta name="copyright" content="Ayanamists"><meta name="generator" content="Hexo 5.2.0"><meta name="theme" content="hexo-theme-yun"><title>802.11i 无线网络安全（二）-- 802.1x eap认证 | AyanamistsBlog</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.21/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_ed8vp4atwoj.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>document.addEventListener("DOMContentLoaded", () => {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
});
</script><link rel="shortcut icon" type="image/svg+xml" href="/yun.svg"><link rel="mask-icon" href="/yun.svg" color="#0078E7"><link rel="alternate icon" href="/yun.ico"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"example.com","root":"/","title":"云游君的小站","version":"1.2.0","mode":"auto","copycode":true,"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><meta name="description" content="为什么需要EAP认证 本文要搞清楚的主要问题 对整个802.1x EAP认证架构的简单介绍 搭建使用EAP的802.11无线网络  搭建supplicant 搭建Radius Server 搭建AP 说明   连接到这个无线网路  使用PEAP方法 使用EAP－TLS方法   分析EAP－TLS方法的全过程  Clinet Certificate与tls1.2中的Client Certifica">
<meta property="og:type" content="article">
<meta property="og:title" content="802.11i 无线网络安全（二）-- 802.1x eap认证">
<meta property="og:url" content="http://example.com/2020/02/14/2020-02-14-eap/index.html">
<meta property="og:site_name" content="AyanamistsBlog">
<meta property="og:description" content="为什么需要EAP认证 本文要搞清楚的主要问题 对整个802.1x EAP认证架构的简单介绍 搭建使用EAP的802.11无线网络  搭建supplicant 搭建Radius Server 搭建AP 说明   连接到这个无线网路  使用PEAP方法 使用EAP－TLS方法   分析EAP－TLS方法的全过程  Clinet Certificate与tls1.2中的Client Certifica">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/02/14/qM7h4IWTSYptlAC.png">
<meta property="og:image" content="https://i.loli.net/2020/02/14/5XSJcP9bneWv7LQ.png">
<meta property="og:image" content="https://i.loli.net/2020/02/14/TJhdktbIyjoqQuz.png">
<meta property="og:image" content="https://slideplayer.com/slide/4802754/15/images/19/Through+the+protocol+stack.jpg">
<meta property="og:image" content="https://i.loli.net/2020/02/14/GN7PgKzLWIib3fZ.png">
<meta property="og:image" content="https://i.loli.net/2020/02/14/IcFwZpj9BxTDl3b.png">
<meta property="og:image" content="https://i.loli.net/2020/02/14/h2xVkQqc7KiEOUT.png">
<meta property="og:image" content="https://i.loli.net/2020/02/14/brgWiSUOe2FK6nX.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46481848b86553ee0f20df.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46481848b86553ee0f20e2.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46481848b86553ee0f20e4.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46481848b86553ee0f20e6.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4647ff48b86553ee0f1597.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46481848b86553ee0f20e8.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4650f348b86553ee1226df.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4684c748b86553ee250255.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46850f48b86553ee2521c4.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46850f48b86553ee2521c6.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46859d48b86553ee2562c3.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4685cf48b86553ee257d24.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4685cf48b86553ee257d27.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4685f548b86553ee25ad82.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46865748b86553ee260de9.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e46868248b86553ee262794.png">
<meta property="og:image" content="https://pic.downk.cc/item/5e4686bc48b86553ee264917.png">
<meta property="article:published_time" content="2020-02-14T00:00:00.000Z">
<meta property="article:modified_time" content="2020-11-03T13:29:40.752Z">
<meta property="article:author" content="Ayanamists">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/02/14/qM7h4IWTSYptlAC.png"><script src="/js/ui/mode.js"></script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.20.0/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
<!-- hexo injector head_end end --></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="Table of Contents"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="Overview"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="Ayanamists"><img width="96" loading="lazy" src="/Yun.png" alt="Ayanamists"></a><div class="site-author-name"><a href="/about/">Ayanamists</a></div><a class="site-name" href="/about/site.html">AyanamistsBlog</a><sub class="site-subtitle"></sub><div class="site-desciption"></div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="Home"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="Archives"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">40</span></a></div><div class="site-state-item"><a href="/categories/" title="Categories"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">9</span></a></div><div class="site-state-item"><a href="/tags/" title="Tags"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">0</span></a></div><a class="site-state-item hty-icon-button" target="_blank" rel="noopener" href="https://yun.yunyoujun.cn" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81eap%E8%AE%A4%E8%AF%81"><span class="toc-number">1.</span> <span class="toc-text"> 为什么需要EAP认证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E6%96%87%E8%A6%81%E6%90%9E%E6%B8%85%E6%A5%9A%E7%9A%84%E4%B8%BB%E8%A6%81%E9%97%AE%E9%A2%98"><span class="toc-number">2.</span> <span class="toc-text"> 本文要搞清楚的主要问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E6%95%B4%E4%B8%AA8021x-eap%E8%AE%A4%E8%AF%81%E6%9E%B6%E6%9E%84%E7%9A%84%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D"><span class="toc-number">3.</span> <span class="toc-text"> 对整个802.1x EAP认证架构的简单介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8eap%E7%9A%8480211%E6%97%A0%E7%BA%BF%E7%BD%91%E7%BB%9C"><span class="toc-number">4.</span> <span class="toc-text"> 搭建使用EAP的802.11无线网络</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAsupplicant"><span class="toc-number">4.1.</span> <span class="toc-text"> 搭建supplicant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAradius-server"><span class="toc-number">4.2.</span> <span class="toc-text"> 搭建Radius Server</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAap"><span class="toc-number">4.3.</span> <span class="toc-text"> 搭建AP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B4%E6%98%8E"><span class="toc-number">4.4.</span> <span class="toc-text"> 说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E5%88%B0%E8%BF%99%E4%B8%AA%E6%97%A0%E7%BA%BF%E7%BD%91%E8%B7%AF"><span class="toc-number">5.</span> <span class="toc-text"> 连接到这个无线网路</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8peap%E6%96%B9%E6%B3%95"><span class="toc-number">5.1.</span> <span class="toc-text"> 使用PEAP方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8eap-tls%E6%96%B9%E6%B3%95"><span class="toc-number">5.2.</span> <span class="toc-text"> 使用EAP－TLS方法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%9E%90eap-tls%E6%96%B9%E6%B3%95%E7%9A%84%E5%85%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">6.</span> <span class="toc-text"> 分析EAP－TLS方法的全过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#clinet-certificate%E4%B8%8Etls12%E4%B8%AD%E7%9A%84client-certificate-certificate-verify%E5%B8%A7"><span class="toc-number">6.1.</span> <span class="toc-text"> Clinet Certificate与tls1.2中的Client Certificate、Certificate Verify帧</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eap-tls%E6%96%B9%E6%B3%95%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81"><span class="toc-number">6.2.</span> <span class="toc-text"> EAP-TLS方法如何进行双向认证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#eap-tls%E6%96%B9%E6%B3%95%E7%9A%84%E5%8D%8F%E8%AE%AE%E6%A0%88"><span class="toc-number">6.3.</span> <span class="toc-text"> EAP-TLS方法的协议栈</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5-%E5%8F%91%E9%80%81%E8%BA%AB%E4%BB%BD%E4%BF%A1%E6%81%AF"><span class="toc-number">6.4.</span> <span class="toc-text"> 第一阶段 ：发送身份信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5-%E5%8D%8F%E5%95%86eap%E6%96%B9%E6%B3%95"><span class="toc-number">6.5.</span> <span class="toc-text"> 第二阶段 ：协商EAP方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5-eap-tls%E8%BF%87%E7%A8%8B"><span class="toc-number">6.6.</span> <span class="toc-text"> 第三阶段 ：EAP-TLS过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E5%9B%9B%E9%98%B6%E6%AE%B5-eap%E6%88%90%E5%8A%9F%E5%A4%B1%E8%B4%A5"><span class="toc-number">6.7.</span> <span class="toc-text"> 第四阶段 ：EAP成功／失败</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#eap-tls%E5%A6%82%E4%BD%95%E4%B8%BA80211i%E7%9A%84key-hierarchy%E8%BF%87%E7%A8%8B%E6%8F%90%E4%BE%9Bpmk"><span class="toc-number">7.</span> <span class="toc-text"> EAP-TLS如何为802.11i的Key Hierarchy过程提供PMK</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">8.</span> <span class="toc-text"> 总结</span></a></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://example.com/2020/02/14/2020-02-14-eap/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="Ayanamists"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="AyanamistsBlog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">802.11i 无线网络安全（二）-- 802.1x eap认证</h1><div class="post-meta"><div class="post-time" style="display:inline-block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="Created: 2020-02-14 00:00:00" itemprop="dateCreated datePublished" datetime="2020-02-14T00:00:00+00:00">2020-02-14</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="Modified: 2020-11-03 13:29:40" itemprop="dateModified" datetime="2020-11-03T13:29:40+00:00">2020-11-03</time></div><div class="post-classify"><span class="post-category"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span> <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category" href="/categories/802-11i/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">802.11i</span></a></span></span></div><div class="post-author"><span class="author-name">ayanamists</span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><ul>
<li><a href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81eap%e8%ae%a4%e8%af%81">为什么需要EAP认证</a></li>
<li><a href="#%e6%9c%ac%e6%96%87%e8%a6%81%e6%90%9e%e6%b8%85%e6%a5%9a%e7%9a%84%e4%b8%bb%e8%a6%81%e9%97%ae%e9%a2%98">本文要搞清楚的主要问题</a></li>
<li><a href="#%e5%af%b9%e6%95%b4%e4%b8%aa8021x-eap%e8%ae%a4%e8%af%81%e6%9e%b6%e6%9e%84%e7%9a%84%e7%ae%80%e5%8d%95%e4%bb%8b%e7%bb%8d">对整个802.1x EAP认证架构的简单介绍</a></li>
<li><a href="#%e6%90%ad%e5%bb%ba%e4%bd%bf%e7%94%a8eap%e7%9a%8480211%e6%97%a0%e7%ba%bf%e7%bd%91%e7%bb%9c">搭建使用EAP的802.11无线网络</a>
<ul>
<li><a href="#%e6%90%ad%e5%bb%basupplicant">搭建supplicant</a></li>
<li><a href="#%e6%90%ad%e5%bb%baradius-server">搭建Radius Server</a></li>
<li><a href="#%e6%90%ad%e5%bb%baap">搭建AP</a></li>
<li><a href="#%e8%af%b4%e6%98%8e">说明</a></li>
</ul>
</li>
<li><a href="#%e8%bf%9e%e6%8e%a5%e5%88%b0%e8%bf%99%e4%b8%aa%e6%97%a0%e7%ba%bf%e7%bd%91%e8%b7%af">连接到这个无线网路</a>
<ul>
<li><a href="#%e4%bd%bf%e7%94%a8peap%e6%96%b9%e6%b3%95">使用PEAP方法</a></li>
<li><a href="#%e4%bd%bf%e7%94%a8eap%ef%bc%8dtls%e6%96%b9%e6%b3%95">使用EAP－TLS方法</a></li>
</ul>
</li>
<li><a href="#%e5%88%86%e6%9e%90eap%ef%bc%8dtls%e6%96%b9%e6%b3%95%e7%9a%84%e5%85%a8%e8%bf%87%e7%a8%8b">分析EAP－TLS方法的全过程</a>
<ul>
<li><a href="#clinet-certificate%e4%b8%8etls12%e4%b8%ad%e7%9a%84client-certificatecertificate-verify%e5%b8%a7">Clinet Certificate与tls1.2中的Client Certificate、Certificate Verify帧</a></li>
<li><a href="#eap-tls%e6%96%b9%e6%b3%95%e5%a6%82%e4%bd%95%e8%bf%9b%e8%a1%8c%e5%8f%8c%e5%90%91%e8%ae%a4%e8%af%81">EAP-TLS方法如何进行双向认证</a></li>
<li><a href="#eap-tls%e6%96%b9%e6%b3%95%e7%9a%84%e5%8d%8f%e8%ae%ae%e6%a0%88">EAP-TLS方法的协议栈</a></li>
<li><a href="#%e7%ac%ac%e4%b8%80%e9%98%b6%e6%ae%b5-%e5%8f%91%e9%80%81%e8%ba%ab%e4%bb%bd%e4%bf%a1%e6%81%af">第一阶段 ：发送身份信息</a></li>
<li><a href="#%e7%ac%ac%e4%ba%8c%e9%98%b6%e6%ae%b5-%e5%8d%8f%e5%95%86eap%e6%96%b9%e6%b3%95">第二阶段 ：协商EAP方法</a></li>
<li><a href="#%e7%ac%ac%e4%b8%89%e9%98%b6%e6%ae%b5-eap-tls%e8%bf%87%e7%a8%8b">第三阶段 ：EAP-TLS过程</a></li>
<li><a href="#%e7%ac%ac%e5%9b%9b%e9%98%b6%e6%ae%b5-eap%e6%88%90%e5%8a%9f%ef%bc%8f%e5%a4%b1%e8%b4%a5">第四阶段 ：EAP成功／失败</a></li>
</ul>
</li>
<li><a href="#eap-tls%e5%a6%82%e4%bd%95%e4%b8%ba80211i%e7%9a%84key-hierarchy%e8%bf%87%e7%a8%8b%e6%8f%90%e4%be%9bpmk">EAP-TLS如何为802.11i的Key Hierarchy过程提供PMK</a></li>
<li><a href="#%e6%80%bb%e7%bb%93">总结</a></li>
</ul>
<h2 id="为什么需要eap认证"><a class="markdownIt-Anchor" href="#为什么需要eap认证"></a> 为什么需要EAP认证</h2>
<p>我们在<a href="!--swig%EF%BF%BC7--">无线网络安全（1）</a>中说过，所谓的“认证”，在802.11i的RSN（或者说，WPA）中有两种方式，一种是<strong>802.1x EAP</strong>认证，一种是<strong>pre-shared-key</strong>认证，而<strong>pre-shared-key</strong>认证直接跳过认证过程，通过“四次握手”(密钥生成与分发)过程，验证<strong>AP</strong>和<strong>STA</strong>对于<strong>PSK</strong>的所有权，是一种相互认证。</p>
<p>但<strong>pre-shared-key</strong>认证有一些缺陷。以我们的无线校园网<strong>SYSU_SECURE</strong>为例，如果采取<strong>pre-shared-key</strong>认证，那么就会遇到很多问题：</p>
<ul>
<li>向一个人分发一份<strong>pre-shared-key</strong>，本意是让一个人使用。但由于密钥生成与分发过程只验证AP和STA对<strong>PSK</strong>的所有权，如果这个人（A）将<strong>PSK</strong>送给了另一个人(B)，那么B也可以用这个<strong>PSK</strong>连接校园网。</li>
<li>更新<strong>PSK</strong>时如何安全地通知全校同学？</li>
</ul>
<p>实际上，如果范围很大的话，我们很难控制<strong>PSK</strong>的传播。在802.11i中引入EAP，就是为了解决大规模无线网络的认证问题。</p>
<h2 id="本文要搞清楚的主要问题"><a class="markdownIt-Anchor" href="#本文要搞清楚的主要问题"></a> 本文要搞清楚的主要问题</h2>
<ul>
<li>什么是EAP？</li>
<li>使用802.1x EAP认证方法如何产生802.11i需要的PMK?</li>
<li>如何搭建一个WPA2-Enterprise或者说使用802.1x EAP认证方法的无线网络？</li>
<li>EAP-TLS如何进行双向验证？</li>
</ul>
<h2 id="对整个8021x-eap认证架构的简单介绍"><a class="markdownIt-Anchor" href="#对整个8021x-eap认证架构的简单介绍"></a> 对整个802.1x EAP认证架构的简单介绍</h2>
<p>EAP这个东西，是古董。在PPP链路大行其道的时代，EAP就出现了。它最初就是为了解决PPP的认证问题而引入的。对它的具体描述，参见<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3748">rfc3748</a>。EAP叫做“可扩展认证协议”，它只规定了一个壳子，我们可以通过各种方法改造它以适应我们的要求。</p>
<p>而802.1x，是所谓的“基于端口的介质访问控制”ieee标准。什么意思呢？就是说，在客户端没有认证之前，客户端只能通过“被控制的端口”（controlled port）和网络接入点（比如AP、交换机、路由器等等）进行通信。这就说是，在没有认证之前，网络接入点只接受客户端发来的802.1x帧（在以太网里，TYPE字段值为0x888e），其他的一律扔掉。这样一来，客户端虽然在物理上可以和网络接入点进行通信，但是只能进行认证而不能和别的终端进行通信。如果客户端进行了认证，那么，客户端就可以从不被控制的端口（uncontrolled port）通信，简单地来说就是可以上网了。这样一来，802.1x就提供了一种在以太网上进行访问控制的方法。</p>
<p>那么，802.1x和EAP的关系是怎么样的呢？这是一个略复杂的问题。我们说，在以太网上，TYPE字段设置为0x888e就代表上层协议是802.1x。而它上层的协议包，被称为EAPOL（EAP over LAN），也就是EAP在Lan上的实现。它的包格式被802.1x规定如下：</p>
<p><img src="https://i.loli.net/2020/02/14/qM7h4IWTSYptlAC.png" alt="1.PNG" / loading="lazy"></p>
<p>可是令人迷惑的是，EAP协议有自己的包格式：</p>
<p><img src="https://i.loli.net/2020/02/14/5XSJcP9bneWv7LQ.png" alt="2.PNG" / loading="lazy"></p>
<p>那么，在以太网或者802.11无线网中，使用的包格式究竟是哪一套呢？</p>
<p>答案很简单，这两套都使用。而且这两套包的层次是不同的。简单地说，802.1x的作用是“访问控制”，EAP的作用是“认证”。我们先按下不表，看看这个认证体系的拓扑架构：</p>
<p><img src="https://i.loli.net/2020/02/14/TJhdktbIyjoqQuz.png" alt="3.PNG" / loading="lazy"></p>
<p>我们发现，在这个架构里，有三个角色：</p>
<ul>
<li>host – 客户</li>
<li>Network Access Server – <strong>NAS</strong>网络接入服务器</li>
<li>Authentication Server – 认证服务器</li>
</ul>
<p>这三个角色的作用和它的名字基本一样。那么，我们发现，在这个体系中，“认证”是委托给认证服务器做的。但认证服务器和客户的通信必须借助<strong>NAS</strong>的转发。而<strong>NAS</strong>转发的包，就是EAP包；客户和<strong>NAS</strong>的通信，是802.1x,或者说是EAPOL包, EAP包被封装在EAPOL包中；<strong>NAS</strong>和认证服务器的通信，是RADIUS包。实际上，整个协议栈可以如下示意：</p>
<p><img src="https://slideplayer.com/slide/4802754/15/images/19/Through+the+protocol+stack.jpg" alt="4.PNG" / loading="lazy"></p>
<p>实际上，如果仔细看802.1x-2010的话, 当EAPOL包的TYPE字段被设置为0时, 这个包的PacketBody字段就会是一个EAP包:</p>
<p><img src="https://i.loli.net/2020/02/14/GN7PgKzLWIib3fZ.png" alt="5.PNG" / loading="lazy"></p>
<p>我们用wireshark抓包也会看到这一点:</p>
<p><img src="https://i.loli.net/2020/02/14/IcFwZpj9BxTDl3b.png" alt="6.PNG" / loading="lazy"></p>
<p>为什么说EAP是用来认证的?因为EAP包是客户和认证服务器用来作认证通信的。理解了这一点，让我们暂时放下理论，先搭建一套使用EAP的802.11无线网络吧。</p>
<h2 id="搭建使用eap的80211无线网络"><a class="markdownIt-Anchor" href="#搭建使用eap的80211无线网络"></a> 搭建使用EAP的802.11无线网络</h2>
<p>根据802.1x认证的构成要件，这里的无线网络至少要由三个部分：</p>
<ul>
<li>suplicant – 客户</li>
<li>Access Point – 无线接入点<strong>AP</strong></li>
<li>Radius Server – Radius 服务器</li>
</ul>
<p>需要指出的是，这里的<strong>AP</strong>是“胖AP”，也就是说，它既担任接入点，又担任DHCP Server和Radius client，如果将AP换做所谓的“瘦AP”，那么，这里会有四个部分。</p>
<h3 id="搭建supplicant"><a class="markdownIt-Anchor" href="#搭建supplicant"></a> 搭建supplicant</h3>
<p>现在的各种操作系统都有直接连接EAP方法的无线网的组件，这一步不用自己做什么。</p>
<h3 id="搭建radius-server"><a class="markdownIt-Anchor" href="#搭建radius-server"></a> 搭建Radius Server</h3>
<p>这里我们使用了<a target="_blank" rel="noopener" href="https://freeradius.org/">FreeRadius</a>这个开源的Radius服务器，在ubuntu18.04 LTS上搭建了Radius服务器。</p>
<p>配置步骤如下：</p>
<ol>
<li>
<p>在终端中输入</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">sudo apt-get install freeradius<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>安装完成后，打开服务器，修改/etc/freeradius/users，添加一个用户，并使用radtest进行测试：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">echo bob Cleartext-Password :&#x3D; &quot;hello&quot; &gt;&gt; &#x2F;etc&#x2F;users
sudo freeradus -X
radtest bob hello 127.0.0.1 0 testing123<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>测试成功后，切换到/etc/freeradius/3.0/certs目录，修改client.cnf，填写自己在users中的用户相关信息（比如CN = bob），并使用make工具产生证书：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">vim client.cnf
make<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li>
<p>修改/etc/freeradius/3.0/mods-enabled/eap文件，将ca证书改成刚刚修改好的证书：</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">ca_file &#x3D; &#x2F;etc&#x2F;freeradius&#x2F;3.0&#x2F;certs&#x2F;ca.pem<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li>
<p>修改/etc/freeradius/3.0/client.conf文件，新建一个clinet，准备与ap连接</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">client 192.168.1.1 &#123;
  ipaddr &#x3D; 192.168.1.1
  proto &#x3D; *
  secret &#x3D; testing123
&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li>
<p>将此服务器和AP连接到同一个网络，这里我使用的是虚拟机，所以新建了一块桥接网卡。</p>
</li>
</ol>
<p>至此，Radius服务器就建好了，下面搭建AP。</p>
<h3 id="搭建ap"><a class="markdownIt-Anchor" href="#搭建ap"></a> 搭建AP</h3>
<p>这里我们采用了我家的家用路由器。</p>
<ul>
<li>型号：ASUS RT-AC87R</li>
<li>固件版本：华硕原生固件 3.0.0.4.376_2769-g1bb5fac</li>
</ul>
<p>配置步骤如下：</p>
<ol>
<li>在<strong>无线网络-一般设置</strong>中将2.4G的验证方式设置为WPA-Enterprise。</li>
<li>在<strong>无线网络-Radius设置</strong>中，填写Radius服务器地址、端口、密码等信息。</li>
</ol>
<p>至此，AP配置完成。</p>
<h3 id="说明"><a class="markdownIt-Anchor" href="#说明"></a> 说明</h3>
<p>freeradius是一个很强的服务器，如果搭建到了这里，它的默认设置就几乎可以支持市面上常见的所有EAP方法，包括EAP-MD5、EAP-TLS、EAP-TTLS、EAP-PEAP等。</p>
<h2 id="连接到这个无线网路"><a class="markdownIt-Anchor" href="#连接到这个无线网路"></a> 连接到这个无线网路</h2>
<h3 id="使用peap方法"><a class="markdownIt-Anchor" href="#使用peap方法"></a> 使用PEAP方法</h3>
<p>在Windows平台和ios平台下，直接连接上面的无线网络，操作系统会默认使用PEAP方法。在GUI中输入用户名和密码即可。</p>
<h3 id="使用eap-tls方法"><a class="markdownIt-Anchor" href="#使用eap-tls方法"></a> 使用EAP－TLS方法</h3>
<p>为什么要使用EAP－TLS方法呢？因为PEAP方法会第一阶段会创造tls信道，第二阶段分析起来不太方便。我们对TLS也相当熟悉，所以决定使用EAP-TLS方法进行分析整个连接过程。如果要分析，就必须先连接上。这里使用Windows平台进行连接。</p>
<p>在上一步的配置中，freeradius会产生一堆证书：</p>
<p><img src="https://i.loli.net/2020/02/14/h2xVkQqc7KiEOUT.png" alt="7.PNG" / loading="lazy"></p>
<p>将clinet.p12复制一份到windows平台下，双击，进行安装。注意选择“标记为可导出的证书”选项。</p>
<p><img src="https://i.loli.net/2020/02/14/brgWiSUOe2FK6nX.png" alt="8.PNG" / loading="lazy"></p>
<p>然后在控制面版中新建一个无线连接：</p>
<p><img src="https://pic.downk.cc/item/5e46481848b86553ee0f20df.png" alt="" / loading="lazy"></p>
<p>填写相关参数，并选择<strong>下一步</strong>：</p>
<p><img src="https://pic.downk.cc/item/5e46481848b86553ee0f20e2.png" alt="" / loading="lazy"></p>
<p>选择<strong>更改连接设置</strong>：</p>
<p><img src="https://pic.downk.cc/item/5e46481848b86553ee0f20e4.png" alt="" / loading="lazy"></p>
<p>在这个界面需要更改两个内容：</p>
<p><img src="https://pic.downk.cc/item/5e46481848b86553ee0f20e6.png" alt="" / loading="lazy"></p>
<ol>
<li>
<p>在<strong>高级设置</strong>中将<strong>指定身份验证模式</strong>改为<strong>用户身份验证</strong></p>
<p><img src="https://pic.downk.cc/item/5e4647ff48b86553ee0f1597.png" alt="14.png" / loading="lazy"></p>
</li>
<li>
<p>在<strong>选择网络身份验证方法</strong>中选择<strong>Microsoft智能卡或其他证书</strong>，并点击<strong>设置</strong></p>
<p>在<strong>设置</strong>页面取消对<strong>通过验证证书验证服务器的身份</strong>的选择：</p>
<p><img src="https://pic.downk.cc/item/5e46481848b86553ee0f20e8.png" alt="" / loading="lazy"></p>
</li>
</ol>
<p>然后，在GUI中直接连接。</p>
<h2 id="分析eap-tls方法的全过程"><a class="markdownIt-Anchor" href="#分析eap-tls方法的全过程"></a> 分析EAP－TLS方法的全过程</h2>
<p>在刚才的连接过程中，我们可以看到，整个设置很繁琐。这是因为EAP-TLS使用了<strong>Client Certificate</strong>来验证客户端的有效性。</p>
<h3 id="clinet-certificate与tls12中的client-certificate-certificate-verify帧"><a class="markdownIt-Anchor" href="#clinet-certificate与tls12中的client-certificate-certificate-verify帧"></a> Clinet Certificate与tls1.2中的Client Certificate、Certificate Verify帧</h3>
<p>在<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc3748">rfc5246</a>中，定义了一个我们在TLS系列中没有分析过的帧 – <strong>clinet certificate</strong>. 这一帧是在收到服务器发来的<strong>Certificate Request</strong>帧后，客户端必须发送的帧。服务端通过这一帧来验证客户端的的身份。然而，在https的世界里，我们很少使用这个东西。因为http对应的主要是web应用，web应用一般不会要求验证用户的身份，即使真的要求，基于https的身份验证也会让使用http的用户无法登录，还有部署麻烦等劣势，所以用的很少，我们在之前的TLS文章中也没有研究。</p>
<p>这一帧的结构如下：</p>
<blockquote>
<p>Client certificates are sent using the Certificate structure defined in Section 7.4.2.</p>
</blockquote>
<p>7.4.2是Server Certificate的定义，所以这里也和Server Certificate一样，是直接<strong>明文</strong>发过去的。</p>
<p>回忆TLS中对于Server Certificate的验证，我们会发现，如果只发送Client Certificate帧，是不能验证客户端对于这个证书的所有权的，验证所有权的关键，应该是私钥。客户端对证书的所有权，是Certificate Verify帧验证的。</p>
<p>这一帧的结构如下：</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">struct</span> <span class="token punctuation">&#123;</span>
    digitally<span class="token operator">-</span><span class="token keyword">signed</span> <span class="token keyword">struct</span>
    <span class="token punctuation">&#123;</span>
        opaque handshake_messages<span class="token punctuation">[</span>handshake_messages_length<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> CertificateVerify<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>handshake_messages指的是从握手开始到握手结束的所有消息的连接，而digitally-signed正是指客户端需要用私钥加密这些消息。这样一来，服务端端用证书中的公钥解密，判断一下是否和自己存储/打的哈希一致，就可以验证客户端对证书的所有权了。</p>
<h3 id="eap-tls方法如何进行双向认证"><a class="markdownIt-Anchor" href="#eap-tls方法如何进行双向认证"></a> EAP-TLS方法如何进行双向认证</h3>
<ul>
<li>客户端认证服务端：通过tls的密钥交换，是标准的tls方法，和一般使用的tls一致。</li>
<li>服务端认证客户端：通过Client Certificate和Certificate Verify消息，是标准的tls方法，但不常用。</li>
</ul>
<h3 id="eap-tls方法的协议栈"><a class="markdownIt-Anchor" href="#eap-tls方法的协议栈"></a> EAP-TLS方法的协议栈</h3>
<p>既然这个方法名字叫做EAP-TLS，那么就是使用TLS来进行双向认证的。这里有个问题，那就是我们现在无法使用IP协议和TCP协议，如何使用TLS呢？这里采取的方法是，将TLS的帧封装在EAP协议中。</p>
<p>用wireshark抓包，可以很清晰地看出这个情况：</p>
<p><img src="https://pic.downk.cc/item/5e4650f348b86553ee1226df.png" alt="" / loading="lazy"></p>
<p>下面我们来分析认证的全过程。</p>
<h3 id="第一阶段-发送身份信息"><a class="markdownIt-Anchor" href="#第一阶段-发送身份信息"></a> 第一阶段 ：发送身份信息</h3>
<p>首先需要说明，以下所有的通信都是发生于Radius Server（认证服务器）和STA之间的，AP只是起转发作用。</p>
<p>在做完<strong>NULL　Authentication</strong>之后，STA发送EAPOL_Start帧，表明开始进行802.1x认证：</p>
<p><img src="https://pic.downk.cc/item/5e4684c748b86553ee250255.png" alt="" / loading="lazy"></p>
<p>之后，STA回应AP的Request Identity消息，发送自己的身份信息：</p>
<p><img src="https://pic.downk.cc/item/5e46850f48b86553ee2521c4.png" alt="" / loading="lazy"><br />
<img src="https://pic.downk.cc/item/5e46850f48b86553ee2521c6.png" alt="" / loading="lazy"></p>
<p>如果身份信息合法，进入下一阶段</p>
<h3 id="第二阶段-协商eap方法"><a class="markdownIt-Anchor" href="#第二阶段-协商eap方法"></a> 第二阶段 ：协商EAP方法</h3>
<p>AP发送Request-MD5-Challenge消息，要求使用EAP-MD5-Challenge方法：</p>
<p><img src="https://pic.downk.cc/item/5e46859d48b86553ee2562c3.png" alt="" / loading="lazy"></p>
<p>客户端不同意，发送NAK消息，并指出自己想使用EAP-TLS方法：</p>
<p><img src="https://pic.downk.cc/item/5e4685cf48b86553ee257d24.png" alt="" / loading="lazy"></p>
<p><img src="https://pic.downk.cc/item/5e4685cf48b86553ee257d27.png" alt="" / loading="lazy"></p>
<p>AP换用EAP-tls方法，发送Request-eap-tls消息：</p>
<p><img src="https://pic.downk.cc/item/5e4685f548b86553ee25ad82.png" alt="" / loading="lazy"></p>
<p>下面的消息就全部是tls协议帧了。</p>
<h3 id="第三阶段-eap-tls过程"><a class="markdownIt-Anchor" href="#第三阶段-eap-tls过程"></a> 第三阶段 ：EAP-TLS过程</h3>
<p>eap-tls由rfc2716定义，现在通行的是<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2548">rfc5216</a>。</p>
<p>成功的eap-tls整个过程大概有三种情况，一种是标准的tls握手过程，另一种是标准的tls快速恢复握手过程，还有一种是支持privacy的两次握手。这里只观察到了第一种，故只讨论第一种。</p>
<p>此过程和一般的tls握手过程主要有以下区别：</p>
<ul>
<li>服务端发送Certificate Request消息，客户端回应client Certificate 和 Certificate Verify消息。</li>
<li>同时进行EAP-TLS Key Hierarchy过程。注意，这并不是说TLS的Key Hierarchy过程就不进行了，而是说另外地进行其他的Key Hierarchy过程。由于握手过程的最后一帧finished是加密的，所以标准的TLS的Key Hierarchy也是必须的。</li>
</ul>
<p>抓包结果如下：</p>
<p><img src="https://pic.downk.cc/item/5e46865748b86553ee260de9.png" alt="" / loading="lazy"></p>
<h3 id="第四阶段-eap成功失败"><a class="markdownIt-Anchor" href="#第四阶段-eap成功失败"></a> 第四阶段 ：EAP成功／失败</h3>
<p>如果成功，AP向STA发送EAP　Success消息，如果失败，AP向STA发送EAP Failure消息。</p>
<p><img src="https://pic.downk.cc/item/5e46868248b86553ee262794.png" alt="" / loading="lazy"></p>
<h2 id="eap-tls如何为80211i的key-hierarchy过程提供pmk"><a class="markdownIt-Anchor" href="#eap-tls如何为80211i的key-hierarchy过程提供pmk"></a> EAP-TLS如何为802.11i的Key Hierarchy过程提供PMK</h2>
<p>我们知道，在802.11i无线网络中，Key Hierachy的起点是<strong>PMK</strong>(Pairwise Master Key)。如果使用<strong>PSK</strong>方法，那么<strong>PMK</strong>就是<strong>PSK</strong>。如果使用EAP方法呢？802.11-2007并没有说得很明白，而是使用了May这样的词，但从“密码”到<strong>PSK</strong>所使用的哈希函数也是may，所以还是很有参考价值的。它指向了一个很奇怪的记号：<strong>MS-MPPE-Recv-Key</strong>。这个<strong>MS</strong>恐怕指的就是<strong>Microsoft</strong>了，而这个符号实际上来源于PEAP，是PEAP第一阶段（也是用TLS，只不过没有用Cilent Certificate校验客户端）通过Key Hierarchy产生的密钥。</p>
<p>EAP-TLS提供了一种和标准TLS不同的方法，来生成PMK，在rfc-5216的2.3节中被这样定义：</p>
<pre class="line-numbers language-c++" data-language="c++"><code class="language-c++">Key_Material &#x3D; TLS-PRF-128(master_secret, &quot;client EAP encryption&quot;, client.random || server.random)
MSK &#x3D; Key_Material(0,63)
EMSK &#x3D; Key_Material(64,127)
IV &#x3D; TLS-PRF-64(&quot;&quot;, &quot;client EAP encryption&quot;, client.random || server.random)
Enc-RECV-Key &#x3D; MSK(0,31) 
   &#x2F;*
   Peer to Authenticator Encryption Key
   (MS-MPPE-Recv-Key in [RFC2548]). Also known as the
   PMK in [IEEE-802.11].
   *&#x2F;
Enc-SEND-Key &#x3D; MSK(32,63) 
   &#x2F;*
   Authenticator to Peer Encryption Key
   (MS-MPPE-Send-Key in [RFC2548])
   *&#x2F;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>为什么<strong>MS-MPPE-Recv-Key</strong>成了事实上的<strong>PMK</strong>呢？这似乎有历史原因，我并没有找到一个解释或是说明。但事实就是这样，我们的好奇心也不必过于旺盛。</p>
<p>这时，所有的问题都解决了吗？确实解决了。但是我们又有了新的问题：tls握手是在Authentication Server和Client之间发生的，AP是如何得到Enc-RECV-Key的呢？下一阶段的Key Hierarchy是AP进行的，它必须得到PMK。</p>
<p>我们仔细研究一下Radius Server发给AP的最后一帧：</p>
<p><img src="https://pic.downk.cc/item/5e4686bc48b86553ee264917.png" alt="" / loading="lazy"></p>
<p>图中确实看到了MS-MPPE-RECV-KEY字段，但为什么长度不是0x22(32byte的Key, 1byte的Id，1byte的length)，而是0x34（52）呢？这是因为它不是明文传的，而是加密+padding后的结果。具体是如何加密的，可以参考<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc2548">rfc2548</a>，此处就不赘述了。</p>
<h2 id="总结"><a class="markdownIt-Anchor" href="#总结"></a> 总结</h2>
<p>研究EAP是一件不那么轻松的事，主要原因一是资料少，二是资料基本都是英文的，中文搜索几乎没有什么有用结果。通过写这篇文章、研究这些内容，我已经基本搞清楚了802.11i认证过程的所有过程，不过还有很多坑待填，譬如最后产生的GTK究竟有什么用、如何处理漫游等等问题。不过，相信在不远的将来，我会完全研究清楚这些问题。</p>
<p>最后来谈一谈我在部署过程中所踩的坑。</p>
<ul>
<li>我们必须安装PKCS格式的证书，而不是.crt .pem那样的base64编码的证书（不然私钥无法安装）。</li>
<li>我们必须勾选“允许导出”选项，不然不会使用这张证书。</li>
<li>我们必须设置“用户认证”，不然windows会将我们计算机的主机名在eap identity里传过去。</li>
</ul>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>Post author: </strong>ayanamists</li><li class="post-copyright-link"><strong>Post link: </strong><a href="http://example.com/2020/02/14/2020-02-14-eap/" title="802.11i 无线网络安全（二）-- 802.1x eap认证">http://example.com/2020/02/14/2020-02-14-eap/</a></li><li class="post-copyright-license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> unless stating additionally.</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2020/02/15/2020-02-15-speed-2/" rel="prev" title="谈谈网速（二）不得不首先研究清楚的问题"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">谈谈网速（二）不得不首先研究清楚的问题</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2020/01/02/2020-1-2-sort/" rel="next" title="数据结构 -- 排序 -- 笔记"><span class="post-nav-text">数据结构 -- 排序 -- 笔记</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div id="comment"><div class="comment-tooltip text-center"><span>点击按钮跳转 GitHub Issues 评论。</span><br><span>若没有本文 Issue，您可以使用 Comment 模版新建。</span><br><a class="hty-button hty-button--raised" id="github-issues" target="_blank" rel="noopener" href="https://github.com/YunYouJun/yunyoujun.github.io/issues?q=is:issue+802.11i 无线网络安全（二）-- 802.1x eap认证">GitHub Issues</a></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2019 – 2020 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> Ayanamists</span></div><div class="powered"><span>Powered by <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> v5.2.0</span><span class="footer-separator">|</span><span>Theme - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.2.0</span></div></footer><a class="hty-icon-button" id="goUp" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a></div><script defer src="/js/utils.js"></script><script defer src="/js/hexo-theme-yun.js"></script></body></html>